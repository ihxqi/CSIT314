<!DOCTYPE html>
<html>
    <head>
		<title>Cinema Rooms</title>
        <meta charset = "utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Movie listing</title>
        <link rel ="stylesheet" href = "styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,300;0,400;0,800;1,100;1,400&display=swap" rel="stylesheet">
    </head>
</html>
	<style>
		.search-results 
		{
			margin-top: 20px;
		}
		
		.box 
		{
			display: block;
		}
		
		.hidden
		{
			display: none;
		}
	</style>
<body>
	<div class="white-box">
        <section>
            <div class="container1">
                <div class="logo">
                    <img src="Images/cinemethologo.jpeg">
                </div>
    
                <div class="topnav">
					<a href="#" onclick="logout()">LOG OUT</a>
					<a href="tickets.html">TICKETS</a>
					<a href="cinemaRooms.html">CINEMA ROOMS</a>  
					<a href="movies.html">MOVIES</a>    
					<a href="f&b.html">F&B</a>                				
					<a class="active" href="cinemaManager.html">HOME</a>
                </div>
            </div> 
        </section>

        <hr>
        <br><br>
		<div class="search-container">			
				<input type="text" id="search" placeholder="Search by seat type">
				<div class="search-results"></div>
		</div>
		<table id="roomTable" border="1">
		<tr>
			<th>Room No.</th>
			<th>Capacities</th>
			<th>Seat Types</th>
			<th>Actions</th>
		</tr>
		<tr>
			<td contenteditable="true">1</td>
			<td contenteditable="true">135</td>
			<td class="editable">Not Set</td>
			<td>
				<button onclick="suspend(this)">Suspend</button>
				<button onclick="activate(this)" disabled>Activate</button>
			</td>
		</tr>		
		</table><br>
		
		<button onclick="addRoom()">Add Room</button>
		<button onclick="updateRoom()">Update Room</button>		
	</div>
	
	<script>
		document.getElementById('search').addEventListener('input', function(e) 
		{
			var searchVal = e.target.value.toLowerCase();
			var table = document.getElementById('roomTable');

			for (var i = 1, row; row = table.rows[i]; i++) 
			{
				var seatTypeDropdown = row.cells[2].querySelector('select');
				var seatType = seatTypeDropdown ? seatTypeDropdown.value : ""; 

				if (seatType.toLowerCase().includes(searchVal)) 
				{
					row.style.display = "";
				} 
				else 
				{
					row.style.display = "none";
				}
			}
		});
		
		var seat = document.querySelectorAll(".editable");

		for(var i = 0; i < seat.length; i++)
		{
			seat[i].addEventListener('mousedown', function(e)
			{
				if (!this.querySelector('select'))
				{
					var select = document.createElement('select');
					var options = ['Standard', 'Premium', 'VIP']; 
				}
			
				// Create options and append to select
				for(var j = 0; j < options.length; j++)
				{
					var option = document.createElement('option');
					option.value = options[j];
					option.text = options[j];
					select.appendChild(option);
				}
			
				// When an option is selected, replace the select with the chosen option
				select.addEventListener('change', function(e)
				{
					this.parentElement.innerText = this.value;
				});
				
				select.addEventListener('click', function(e)
				{
					e.stopPropagation();
				});
			
				// Replace cell content with select
				this.innerText = '';
				this.appendChild(select);
				select.focus();
			});
		}	
	
		function addRoom() 
		{
			var table = document.getElementById('roomTable');
			var row = table.insertRow(-1);

			var cell1 = row.insertCell(0);
			var cell2 = row.insertCell(1);
			var cell3 = row.insertCell(2);
			var cell4 = row.insertCell(3);

			cell1.contentEditable = "true";
			cell2.contentEditable = "true";
			cell4.innerHTML = '<button onclick="suspend(this)">Suspend</button><button onclick="activate(this)" disabled>Activate</button>';

			cell1.innerHTML = "New Room No.";
			cell2.innerHTML = " ";
			
			// Create the select element and options for the seat type
			var select = document.createElement('select');
			select.innerHTML = '<option value="Standard">Standard</option><option value="Premium">Premium</option><option value="VIP">VIP</option>';
			select.className = 'editable';

			// Append the select element to the third cell
			cell3.appendChild(select);
		}
		
		function suspend(btn)
		{
			var row = btn.parentNode.parentNode;
			row.style.backgroundColor = 'grey'; // suspended
			row.cells[0].contentEditable = "false";  // Make cells uneditable
			row.cells[1].contentEditable = "false";
			btn.disabled = true;  // Disable the suspend button

			var activateButton = btn.nextElementSibling;
			if (activateButton) 
			{
				activateButton.disabled = false;  // Enable the activate button
			}
		}
		
		function activate(btn) 
		{
		  var row = btn.parentNode.parentNode;
		  row.style.backgroundColor = '';  // Change color back to original
		  row.cells[0].contentEditable = "true";  // Make cells editable
		  row.cells[1].contentEditable = "true";
		  btn.disabled = true;  // Disable the activate button

			var suspendButton = btn.previousElementSibling;
			if (suspendButton) 
			{
				suspendButton.disabled = false;  // Enable the suspend button
			}
		}
	
		function updateRoom() 
		{
			var table = document.getElementById('roomTable');
			for (var i = 1, row; row = table.rows[i]; i++) 
			{
				var room = row.cells[0].innerText;
				var capacities = row.cells[1].innerText;
				var seatTypeDropdown = row.cells[2].querySelector('select');
				var seatType = seatTypeDropdown ? seatTypeDropdown.value : "Not Set";
				console.log('Room No.: ' + room + ', Capacities: ' + capacities + ', Seat Type: ' + seatType);
			}
		}
		
		function logout() 
		{
			// Code to handle logout
			console.log("Logged out");
			window.location.href = 'index.html'; // redirect to login page after logout
		}
	</script>
</body>

